# ğŸš€ Azure DevOps CI/CD Pipeline (Steps-Only) with Deployment to App Service ğŸ‰

Below is your complete Azure DevOps YAML pipeline using **ONLY steps**, including:

- âœ” Node.js setup
- âœ” npm install
- âœ” Copy files
- âœ” Archive ZIP with build number
- âœ” Publish artifact
- âœ” Deploy to Azure App Service
- âœ” Selfâ€‘hosted agent (nakodtech â†’ Agentâ€‘1)
- âœ” No automatic triggers

---

## ğŸ› ï¸ Pipeline Configuration

```yaml
trigger:
  - none

pool:
  name: nakodtech
  demands:
    - agent.name -equals Agent-1
```

---

## ğŸ“¦ Step 1 â€” Use Node.js 24

```yaml
- task: NodeTool@0
  inputs:
    versionSource: "spec"
    versionSpec: "24"
```

ğŸŒ± _This installs Node.js version 24 on your agent._

---

## ğŸ“¥ Step 2 â€” Install npm Packages

```yaml
- task: Npm@1
  inputs:
    command: "install"
    workingDir: "."
```

ğŸ“Œ Installs all dependencies from **package.json**.

---

## ğŸ“‚ Step 3 â€” Copy Files to Staging Directory

```yaml
- task: CopyFiles@2
  inputs:
    SourceFolder: "$(Build.SourcesDirectory)"
    Contents: "**"
    TargetFolder: "$(Build.ArtifactStagingDirectory)"
```

ğŸ“ Copies all project files into the artifact staging folder.

---

## ğŸ—œï¸ Step 4 â€” Archive ZIP with Build Number

```yaml
- task: ArchiveFiles@2
  inputs:
    rootFolderOrFile: "$(Build.ArtifactStagingDirectory)"
    includeRootFolder: false
    archiveType: "zip"
    archiveFile: "$(Build.ArtifactStagingDirectory)/output-$(Build.BuildId).zip"
    replaceExistingArchive: true
```

ğŸ“¦ Produces ZIP files like:
â¡ï¸ `output-101.zip`
â¡ï¸ `output-202.zip`

---

## ğŸ“¤ Step 5 â€” Publish Build Artifact

```yaml
- task: PublishBuildArtifacts@1
  inputs:
    pathToPublish: "$(Build.ArtifactStagingDirectory)/output-$(Build.BuildId).zip"
    artifactName: "drop"
```

ğŸŒ This ZIP becomes the package used by the Release pipeline.

---

## ğŸš€ Step 6 â€” Deploy ZIP to Azure App Service

```yaml
- task: AzureRmWebAppDeployment@4
  inputs:
    ConnectionType: "AzureRM"
    azureSubscription: "webapp-conn"
    appType: "webAppLinux"
    WebAppName: "nodenongo"
    Package: "$(Build.ArtifactStagingDirectory)/output-$(Build.BuildId).zip"
    RuntimeStack: "NODE|18-lts"
```

ğŸŒ Deploys your Node.js app directly to Azure App Service.

â­ FINAL YAML

```yaml
trigger:
  - none

pool:
  name: nakodtech
  demands:
    - agent.name -equals Agent-1

steps:
  # 1ï¸âƒ£ Use Node 24
  - task: NodeTool@0
    inputs:
      versionSource: "spec"
      versionSpec: "24"

  # 2ï¸âƒ£ Install Packages
  - task: Npm@1
    inputs:
      command: "install"
      workingDir: "."

  # 3ï¸âƒ£ Copy Files to Artifact Staging Directory
  - task: CopyFiles@2
    inputs:
      SourceFolder: "$(Build.SourcesDirectory)"
      Contents: "**"
      TargetFolder: "$(Build.ArtifactStagingDirectory)"

  # 4ï¸âƒ£ Archive ZIP using build number
  - task: ArchiveFiles@2
    inputs:
      rootFolderOrFile: "$(Build.ArtifactStagingDirectory)"
      includeRootFolder: false
      archiveType: "zip"
      archiveFile: "$(Build.ArtifactStagingDirectory)/output-$(Build.BuildId).zip"
      replaceExistingArchive: true

  # 5ï¸âƒ£ Publish ZIP Artifact
  - task: PublishBuildArtifacts@1
    inputs:
      pathToPublish: "$(Build.ArtifactStagingDirectory)/output-$(Build.BuildId).zip"
      artifactName: "drop"

  # 6ï¸âƒ£ Deploy to Azure App Service
  - task: AzureRmWebAppDeployment@4
    inputs:
      ConnectionType: "AzureRM"
      azureSubscription: "webapp-conn" # your service connection
      appType: "webAppLinux"
      WebAppName: "nodenongo" # your app service name
      Package: "$(Build.ArtifactStagingDirectory)/output-$(Build.BuildId).zip"
      RuntimeStack: "NODE|18-lts"
```

## ğŸ‰ Final Result

âœ¨ A complete CI/CD pipeline using **only steps**, running on your **selfâ€‘hosted agent**, producing versioned ZIP artifacts, and deploying directly to Azure App Service.

If you'd like, I can also:

- ğŸ”§ Add slot deployment + autoâ€‘swap
- ğŸ— Convert this into a multiâ€‘stage YAML pipeline
- ğŸš€ Add automatic release triggers

Just tell me! ğŸ˜„
